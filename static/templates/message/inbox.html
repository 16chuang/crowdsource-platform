<div class="md-whiteframe-z1 _main-content _middle-content _relative"
     ng-class="{'_sm': $mdMedia('sm'), '_gt-sm': $mdMedia('gt-sm')}"
     style="height: calc(100vh - 79px); z-index: 12; background-color: #ffffff" layout="row">
    <div layout="row" style="height: 100%"
         ng-class="{'_sm': $mdMedia('sm'), '_gt-sm': $mdMedia('gt-sm')}">
        <div class="_task-list" ng-class="{'_task-list-sm': true}"
             layout="column"
             layout-align="start center">
            <div layout="row" layout-align="start center" class="_sheet-header">

                <span ng-cloak="" style="font-weight: 500 !important; margin-left: 10px" class="_header-text _short">Inbox</span>
                <div style="margin-left: auto" layout="row" class="_actions">
                    <md-button class="md-icon-button" ng-click="review.downloadResults()">
                        <md-icon md-font-set="material-icons">message</md-icon>
                        <md-tooltip>New Message</md-tooltip>
                    </md-button>
                </div>
            </div>
            <div class="_task-list-wrapper">
                <div class="_task-entry" ng-click="ctrl.navigateTo('m/'+conversation.recipient_names[0])"
                     ng-repeat="conversation in inbox.conversations"
                     ng-class="{'_task-active': inbox.isSelected(conversation)}">
                    <div class="_item-wrapper">
                        <div class="_entry-item _task-toggle">

                        </div>

                        <div class="_entry-item _md-list-item-text _task-name"
                             ng-class="{'_task-name-sm': $mdMedia('sm'), '_task-name-gt-sm': $mdMedia('gt-sm')}">
                            <h3>{{ conversation.recipient_names[0] }}</h3>
                            <p>{{ conversation.last_message.body }}</p>
                        </div>
                        <div class="_entry-item"
                             style="float: right; color: rgba(0, 0, 0, 0.54); text-transform: capitalize">
                            <span class="_icon-text">{{ conversation.last_message.time_relative }}</span>
                        </div>
                    </div>

                    <md-divider ng-if="!$last"></md-divider>
                </div>
                <div ng-if="inbox.loading" layout="column" class="_loading-text _centered">

                    <md-progress-circular class="_centered"
                                          md-mode="indeterminate"></md-progress-circular>
                    <div>Loading Converstations ...</div>
                </div>
            </div>


        </div>
        <div class="_submissions-sheet" layout="column">
            <div class="_sheet-header _detail-sheet" layout="row" layout-align="start center">
                <span class="_submission-header">{{ inbox.activeRecipient }}</span>
                <div class="_header-actions">

                </div>
            </div>
            <div class="_task-submissions" style="height: 100%; padding-top: 8px;">
                <div class="_no-submissions" ng-cloak=""
                     ng-if="!inbox.loadingThreads && !inbox.conversations.length"> There are no messages, click "
                    <md-icon style="opacity: 0.7" md-font-set="material-icons">message</md-icon>
                    " to start a new one
                </div>
                <div class="_no-selection" ng-cloak="" ng-if="!inbox.loading && !inbox.selectedThread"> No
                    thread selected
                </div>
                <div class="">
                    <div ng-repeat="message in inbox.selectedThread.messages" class="_message" ng-class="{'_mine': message.is_self}">
                        <span>{{ message.body }}</span>
                    </div>
                </div>
            </div>
            <md-divider></md-divider>
            <md-input-container md-no-float class="md-block" style="margin-top: 2px; margin-bottom: 2px">
                <input md-enter="inbox.sendMessage()" style="border-bottom: 0 !important;" ng-model="inbox.newMessage"
                       placeholder="Type a message ...">
            </md-input-container>
        </div>
    </div>

</div>
