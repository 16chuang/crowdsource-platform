<div class="_main-content _middle-content">
  <div layout="row" class="layout-align-start-center _task-nav md-whiteframe-z2">
    <span class="_nav-title _left-inset">Task Feed</span>
  </div>
  <div class="_feed-list">
    <div ng-hide="!project.available_tasks" ng-repeat="project in taskfeed.projects" class="md-whiteframe-z2">
        <div class="_task-top" ng-click="taskfeed.showPreview(project)">
          <div layout="row">
            <div flex="10" class="_price">
              {{ project.price | currency:"$":2}}
            </div>
            <div flex="70" class="_title">
              {{ project.name }}
            </div>
            <div flex="20" class="_author _right-offset" ng-click="taskfeed.openRequesterProfile(project.owner)">
                <div class="_name">{{ project.owner.alias }}</div>
                <span>
                  <div class="_circle" 
                        ng-style="{'background': 'linear-gradient(to right, black 0%, black {{taskfeed.getPercentage(project.requester_rating, 1)}}%, white 0%)'}">
                  </div>
                  <div class="_circle"
                        ng-style="{'background': 'linear-gradient(to right, black 0%, black {{taskfeed.getPercentage(project.requester_rating, 2)}}%, white 0%)'}">
                  </div>
                  <div class="_circle"
                        ng-style="{'background': 'linear-gradient(to right, black 0%, black {{taskfeed.getPercentage(project.requester_rating, 3)}}%, white 0%)'}">
                  </div>
                </span>
            </div>
          </div>
          <div layout="row" class="layout-align-start-center">
            <div flex="10" class="_time">
              {{ project.price * 10 | number: 0}} min
            </div>
            <div flex="70">
              <md-icon md-font-set="material-icons">list</md-icon>
              <ng-pluralize class="_tasks-available" count="project.available_tasks"
                when="{'one': '1 available task', 'other': '{} available tasks'}"></ng-pluralize>
            </div>
            <div flex="20" class="_expand _right-offset">
              <md-icon ng-if="project.show_preview" md-font-set="material-icons" class="_more">expand_less</md-icon>
              <md-icon ng-if="!project.show_preview" md-font-set="material-icons" class="_more">expand_more</md-icon>
            </div>
          </div>
        </div>
        <div class="_preview" ng-if="project.show_preview">
          <div layout="row" class="layout-align-start-center">
            <div flex="10" class="_sample">Sample</div>
            <span flex="90" class="_accept">
              <md-button ng-href="{{ '/task-feed/'+project.id }}"
                           ng-disabled="!project.available_tasks || project.status>3"
                           aria-label="attempt" class="md-action-button no-surround">
                Accept
              </md-button>
            </span>
          </div>
          <div ng-controller="TemplateController as template" class="template-item"
               ng-repeat="item in project.task_template.template_items">
              <div md-template-compiler="item" editor="false" instance="template"></div>
          </div>
        </div>
    </div>
    <div class="_no-tasks md-whiteframe-z2" ng-if="taskfeed.loading">
      <div layout="row" layout-sm="column" layout-align="space-around" class="md-padding">
        <md-progress-circular md-mode="indeterminate"></md-progress-circular>
      </div>
    </div>
    <div class="_no-tasks md-whiteframe-z2" ng-if="!taskfeed.loading && !taskfeed.availableTasks">
        No free tasks available
    </div>
  </div>
</div>
